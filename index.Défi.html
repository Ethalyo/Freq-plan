<!DOCTYPE html> 
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Freq-plan</title>
    
    <style>
        html {
            scroll-behavior: smooth;
        }
        :root {
            --primary: #0056D2;
            --secondary: #00C389;
            --neutral: #F4F6F8;
            --text-dark: #1A1A1A;
            --accent: #FF6B35;
            --dark-bg: #121212;
            --dark-text: #F4F6F8;
            --bg-light: #f5f5f5;
            --border-color: #ccc;
            --primary-color-dark: #388E3C;
        }
        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            background-color: var(--neutral);
            color: var(--text-dark);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }
        body.dark-mode {
            background-color: var(--dark-bg);
            color: var(--dark-text);
        }
        header {
            position: sticky;
            top: 0;
            background-color: var(--primary);
            color: white;
            flex-wrap: wrap;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            align-items: center;
        }
        header.dark-mode {
            background-color: #333;
        }
        header h1 {
            margin: 0;
            font-size: 1.5rem;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
        }
        header nav {
            display: flex;
            gap: 15px;
        }
        header nav a {
            color: white;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }
        header nav a:hover {
            background-color: var(--secondary);
        }
        header nav a.dark-mode {
            color: var(--dark-text);
        }
        header nav a.active {
            border-bottom: 2px solid var(--accent);
        }
        #themeToggle {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: white;
            transition: transform 0.2s;
        }
        #themeToggle:hover {
            transform: scale(1.2);
        }
        section {
            padding: 80px 20px;
        }
        section:nth-child(even) {
            background-color: var(--neutral);
        }
        body.dark-mode section:nth-child(even) {
            background-color: #1e1e1e;
        }
        section:last-child {
            padding-bottom: 300px;
        }
        section h2 {
            text-align: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 20px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            color: var(--primary);
        }
        body.dark-mode section h2 {
            color: var(--secondary);
        }
        #scrollTopBtn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: black;
            transition: color 0.3s, transform 0.2s;
        }
        body.dark-mode #scrollTopBtn {
            color: white;
        }
        #scrollTopBtn:hover {
            transform: scale(1.2);
        }
        @media (min-width: 1528px) {
            .sections-wrapper {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                grid-auto-rows: 1fr;
                gap: 10px;
                padding: 20px;
                margin-top: 80px;
                height: calc(100vh - 80px);
                width: 100vw;
            }
            section {
                overflow-y: auto;
                padding: 10px;
                margin: 0;
            }
            header {
                position: fixed;;
                width: 100%;
                z-index: 1000;
            }
        }
        a:focus, button:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
        a:focus:not(:focus-visible), button:focus:not(:focus-visible) {
            outline: none
        }
        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }
        body.dark-mode #loader {
            background: rgba(0,0,0,0.8);
            color: var(--secondary);
        }
       #runCalcBtn {
        display: block;
        margin: 20px auto 0 auto;
        padding: 10px 20px;
        font-size: 1rem;
        font-weight: 600;
        color: white;
        background-color: var(--primary);
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
       }
       #runCalcBtn:hover {
        background-color: var(--secondary);
        transform: scale(1.05);
       }
       #runCalcBtn:active {
        transform: scale(0.97);
        background-color: var(--secondary);
        transition: transform 0.1s, background-color 0.1s;
       }
       body.dark-mode #runCalcBtn {
        background-color:var(--secondary);
        color: var(--dark-text);
       }
       .version-2 {
        display: flex;
        margin-left: 360px;
        border-radius: 999px;
        border: 1px solid transparent;
        background-color: transparent;
        color: black;
       }
       .version-2:hover {
        transform: scale(1.2);
       }
       body.dark-mode .version-2 {

       }
       .var-inner {
        max-width: 900px;
        margin: 0 auto;
        padding: 12px;
        display: flex;
        flex-direction: column;
        gap: 12px;
       }
       .variable-row {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 15px;
        justify-content: flex-start;
        width: 100%;
        flex-wrap: nowrap;
        transition: all 0.2s;
       }
       .variable-row label {
        width: auto;
        text-align: left;
        margin-left: 165px;
        font-weight: 500;
        color: var(--text-dark);
       }
       body.dark-mode .variable-row label {
        color: var(--dark-text);
       }
       .variable-row .number-wrapper {
        width: 120px;
        flex: 0 0 120px;
       }
       .variable-row .number-wrapper input {
        width: 100%;
        box-sizing: border-box;
       }
       .variable-row input {
        flex: 1;
        max-width: 300px;
        width: 90px;
        padding: 6px 4px 6px 10px;
        border: 1px solid #ccc;
        border-radius: 8px;
        background-color: #fff;
        color: var(--text-dark);
        transition: border 0.2s, box-shadow 0.2s, background-color 0.2s, color 0.2s;
       }
       body.dark-mode .variable-row input {
        background-color: #2a2a2a;
        color: var(--dark-text);
        border-color: #555;
       }
       .variable-row input:focus {
        border-color: var(--primary);
        box-shadow: 0 0 6px var(--primary);
        outline: none;
       }
       .bande-inputs {
        display: inline-flex;
        align-items: center;
        gap: 8px;
       }
       .im-controls {
        display:flex;
        gap: 8px;
        align-items: center;
       }
       .variable-row .unit-arrow,
       .variable-row .unit-mhz,
       .variable-row .unit-khz {
        margin-left: 6px;
       }
       .im-btn {
        padding: 6px 14px;
        margin-right: 6px;
        border: 1px solid var(--primary);
        border-radius: 8px;
        background-color: #fff;
        color: var(--primary);
        cursor: pointer;
        transition: all 0.2s;
        font-weight: 500;
       }
       body.dark-mode .im-btn {
        background-color: #2a2a2a;
        color: var(--primary);
        border-color: var(--secondary);
       }
       .im-btn.active {
        background-color: var(--primary);
        color: #fff;
        border-color: var(--primary);
       }
       body.dark-mode .im-btn.active {
        background-color: var(--secondary);
        color: #fff;
       }
       .im-btn:hover {
        background-color: var(--secondary);
        color:#fff;
        transform: scale(1.05);
       }
       .reset-variable-btn {
          background-color: white;
          color: var(--primary);
          border: 1px solid var(--primary);
          cursor: pointer;
          transition: all 0.2s; 
          border-radius: 8px;
          padding: 6px 14px;
          height: 35px;
          width: 50px;
          display: block;
          margin-left: 178px;
          margin-top: 10px;
         }
         body.dark-mode .reset-variable-btn {
          background-color: #2a2a2a;
          color: var(--primary);
          border: 1px solid var(--secondary);
         }
         .reset-variable-btn:hover {
          background-color: var(--secondary);
          color: #fff;
          transform: scale(1.05);
         }
       input[type=number]::-webkit-outer-spin-button,
       input[type=number]::-webkit-inner-spin-button {
        -webkit-appearence: none;
        margin: 0;
        display: none;
        height: 1em;
        transform: scale(0.8) translateX(-2px);
        margin-left: -600px;
       }
       input[type=number] {
        -moz-appearance: textfield;
       }
       .zone-row {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
        margin-left: 14px;
       }
       .number-wrapper {
        position: relative;
        display: inline-block;
        width: 120px;
       }
       .zone-item .remove-zone-btn {
        padding: 1px 10px;
        font-size: 14px;
        border-radius: 8px;
        border: none;
        background-color: #eee;
        color: var(--text-dark);
        cursor: pointer;
        transition: all 0.2s;
       }
       .zone-item .remove-zone-btn:hover {
        background-color: var(--secondary);
        color: #fff;
       }
       body.dark-mode .zone-item .remove-zone-btn {
        background-color: transparent;
        color: var(--dark-text);
        border: 1px solid #555;
       }
       .zone-container {
        background-color: transparent;
       }
       body.dark-mode .zone-container {
       background-color: transparent;
       }
       .zone-main {
        display: flex;
        gap: 8px;
        align-items: center;
        margin-right: 45px;
       }
       .zone-item input[type="text"], 
       .zone-item input[type="number"] {
        width: 90px;
        padding: 4px 6px;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        transition: background-color 0.3s, color 0.3s, border 0.3s;
       }
       .zone-item input[type="text"]:focus, 
       .zone-item input[type="number"]:focus {
        border-color: var(--primary);
        box-shadow: 0 0 6px var(--primary);
        transition: all 0.2s;
        outline: none;
       }
       body.dark-mode .zone-item input[type="text"],
       body.dark-mode .zone-item input[type="number"] {
        background-color: black;
        color: var(--dark-text);
        border-color: #555;
       }
       .alternance-container {
        margin-right: 60px;
        gap: 13px;
       }
       body.dark-mode .alternance-container {
        background: transparent;
        border-color: none;
        color: var(--dark-text);
       }
       .zone-container input[type="number"] {
        background-color: white;
        border: 1px solid var(--border-color);
        color: black;
        padding: 4px;
        border-radius: 8px;
        box-shadow: none;
        outline: none;
        position: relative;
        top: -0.5px;
        left: -7px;
        width: 100%;
       }
       .zone-container input[type="number"]:focus {
        border-color: var(--primary);
        box-shadow: 0 0 6px var(--primary);
        transition: all 0.2s;
        outline: none;
       }
       body.dark-mode .zone-container input[type="number"] {
        background-color: black;
        border: 1px solid #555;
        color: white;
        padding: 4px;
        border-radius: 8px;
        box-shadow: none;
        outline: none;
        position: relative;
        top: -0.5px;
        left: -7px;
        width: 100%;
       }
       body.dark-mode .zone-container input[type="number"]:focus {
        box-shadow: 0 0 6px var(--primary);
        transition: all 0.2s;
        outline: none;
       }
       .add-zone-btn {
        padding: 6px 6px;
        min-width: 30px;
        max-width: 60px;
        height: 34px;
        background-color: #fff;
        color: var(--primary);
        border-radius: 8px;
        border: 1px solid var(--primary);
        cursor: pointer;
        transition: all 0.2s;
        font-weight: 500;
        text-align: center;
       }
       body.dark-mode .add-zone-btn {
        background-color: #111;
        color: var(--primary);
        border-radius: 8px;
        border: 1px solid var(--secondary);
       }
       .add-zone-btn:hover {
        background-color: var(--secondary);
        color: #fff;
        transform: scale(1.05);
       }
       .zone-controls .add-zone-btn {
        background-color: white;
        color: var(--primary);
        border: 1px solid var(--primary);
        cursor: pointer;
        transition: all 0.2s; 
        border-radius: 8px;
        padding: 6px 12px;
        height: 35px;
        width: 50px;
        margin-right: 5px;
        margin-top: 10px;
       }
       .zone-controls .reset-zone-btn {
        background-color: white;
        color: var(--primary);
        border: 1px solid var(--primary);
        cursor: pointer;
        transition: all 0.2s; 
        border-radius: 8px;
        padding: 6px 12px;
        height: 35px;
        width: 50px;
        margin-right: 216px;
       }
       body.dark-mode .zone-controls .add-zone-btn,
       body.dark-mode .zone-controls .reset-zone-btn {
        background-color: #111;
        color: var(--primary);
        border-color: var(--secondary);
       }
       .zone-controls .add-zone-btn:hover,
       .zone-controls .reset-zone-btn:hover {
        background-color: var(--secondary);
        color: #fff;
       }
       .reset-btn {
        background-color: white;;
        color: var(--primary);
        border: 1px solid var(--primary);
        cursor: pointer;
        transition: all 0.2s; 
       }
       .reset-btn,
       .reset-btn:focus,
       .reset-btn:active {
        background-color: white;
        color: var(--primary);
        border: 1px solid var(--primary);
       }
       .reset-btn:hover {
        background-color: var(--secondary);
        color: white;
       }
       body.dark-mode .reset-btn,
       body.dark-mode .reset-btn:focus,
       body.dark-mode .reset-btn:active {
        background-color: #111;
        color: var(--primary);
        border: 1px solid var(--secondary);
       }
       body.dark-mode.reset-btn:hover {
        background-color: var(--secondary);
        color: #fff;
       }
       .arrow-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 9999px;
        width: 32px;
        height: 32px;
        transition: background-color 0.2s ease, color 0.2s ease;
       }
       .light .arrow-btn {
        background-color: white;
        color: #2563eb;
       }
       .light .arrow-btn:hover {
        background-color: #2563eb;
        color: #60a5fa;
       }
       .dark .arrow-btn {
        background-color: #111827;
        color: #60a5fa;
       }
       .dark .arrow-btn:hover {
        background-color: #2563eb;
        color: white;
       }
       #freqContainer,
       .zone-container,
       .bande-row {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 12px;
        max-width: 900px;
        margin: 0 auto;
        padding: 12px;
        background-color: var(--bg-light);
        border-radius: 8px;
        transition: background-color 0.3s, color 0.3s;
       }
       body.dark-mode #freqContainer {
        background-color: transparent;
        color: var(--dark-text);
       }
       .freq-row {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        margin-bottom: 12px;
        flex-wrap: nowrap;
       }
       .freq-row .number-wrapper {
        display: flex;
        align-items: center;
        gap: 4px;
       }
       .freq-row .number-wrapper input {
        width: 60px;
        padding: 4px;
        border-radius: 8px;
        border: 1px solid #ccc;
        background-color: #fff;
        color: var(--text-dark);
        transition: border 0.2s, box-shadow 0.2s, background-color 0.2s, color 0.2s;
       }
       body.dark-mode .freq-row .number-wrapper input {
        background-color: #2a2a2a;
        color: var(--dark-text);
        border-color: #555;
       }
       .freq-row .number-wrapper input:focus {
        border-color: var(--primary);
        box-shadow: 0 0 6px var(--primary);
        outline: none;
       }
       .freq-row select {
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        background-color: #fff;
        color: var(--text-dark);
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s, border 0.2s;
       }
       body.dark-mode .freq-row select {
        background-color: #2a2a2a;
        color: var(--dark-text);
        border-color: #555;
       }
       .freq-row select:focus {
        border-color: var(--primary);
        box-shadow: 0 0 6px var(--primary);
        outline: none;
       }
       #freqContainer .freq-row:not(:first-child) {
        margin-left: 41px;
       }
         .reset-freq-btn {
          margin-right: 285px;
         }
         .freq-controls button {
            width: auto;
            min-width: 50px;
            padding: 6px 14px;
            height: 34px;
            width: 50px;
            color: var(--primary);
            background-color: #fff;
            border: 1px solid var(--primary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
         }
         body.dark-mode .freq-controls button {
            background-color: #2a2a2a;
            color: var(--primary);
            border-color: var(--secondary);
         }
         .freq-controls button:hover {
            background-color: var(--secondary);
            color: #fff;
            transform: scale(1.05);
         }
         .freq-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 12px;
         }
         body.dark-mode #bandeXContainer input {
            background-color: #2a2a2a;
            color: white;
         }
         .bande-row {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            padding: 12px 16px;
            flex-wrap: no-wrap;
            background-color: var(--bg-light);
            border: none;
            border-radius: 8px;
            gap: 12px;
            transition: background-color 0.3s, color 0.3s, border 0.3s;
            margin-left: 50px;
         }
         body.dark-mode .bande-row {
            background-color: transparent;
         }
         .bande-row label {
            font-weight: 500;
            color: var(--text-dark);
            min-width: 80px;
         }
         body.dark-mode .bande-row label {
            color: var(--dark-text);
         }
         .bande-row input[type="number"] {
            width: 90px;
            padding: 6px 8px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background-color: #fff;
            color: var(--text-dark);
            transition: all 0.2s;
         }
         body.dark-mode .bande-row input[type="number"] {
            background-color: #111;
            color: var(--dark-text);
            border-color: #555;
         }
         .bande-row input[type="number"]:focus {
            border-color: var(--primary);
            box-shadow: 0 0 6px var(--primary);
            outline: none;
         }
         .bande-controls button  {
            width: auto;
            padding: 6px 14px;
            height: 34px;
            width: 50px;
            color: var(--primary);
            background-color: #fff;
            border: 1px solid var(--primary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
         }
         body.dark-mode .bande-controls button {
            background-color: #111;
            color: var(--primary);
            border-color: var(--secondary);
         }
         .bande-controls button:hover {
            background-color: var(--secondary);
            color: #fff;
            transform: scale(1.05);
         }
         .bande-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 12px;
            margin: block;
            margin-right: 175px;
         }
         .freq-row,
         .zone-item .zone-main,
         .bande-row {
            justify-content: center;
            gap: 15px;
         }
         .remove-freq-btn,
         .remove-bande-btn {
            border-radius: 8px;
            padding: 1px 10px;
            font-size: 14px;
            border: none;
            background-color: #eee;
            color: var(--text-dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
         }
         .remove-freq-btn:hover,
         .remove-bande-btn:hover {
            background-color: var(--secondary);
            color: #fff;
         }
         body.dark-mode .remove-freq-btn,
         body.dark-mode .remove-bande-btn {
            background-color: #2a2a2a;
            color: var(--dark-text);
            border: 1px solid #555;
         }
         body.dark-mode .remove-freq-btn:hover,
         body.dark-mode .remove-bande-btn:hover,
         body.dark-mode .remove-zone-btn:hover {
            transform: scale(1.05);
         }
         body.dark-mode #bandeHPContainer .remove-bande-btn {
            background-color: black;
         }
         #bandeHPContainer .bande-row:not(:first-child) {
            margin-left: 89px;
         }
         #bandeXContainer .bande-row:not(:first-child) {
            margin-left: 89px;
         }
         .name-f {
            display: flex;
            margin-left: 270px;
            padding: 6px 8px;
            width: 180px;
            background-color: #fff;
            color: var(--text-dark);
            border-radius: 8px;
            border: 1px solid var(--border-color) ;
         }
         .name-f:focus {
            border-color: var(--primary);
            box-shadow: 0 0 6px var(--primary);
            transition: all 0.2s;
            outline: none;
        }
         body.dark-mode .name-f {
            background-color: black;
            color: white;
            border-color: #555;
         }
         .l-name-f {
            display: flex;
            margin-left: 270px;
         }
         .dossier-s {
           display: flex;
           margin-left: 270px;
           padding: 6px 8px;
           width: 180px;
           background-color: #fff;
           color: var(--text-dark);
           border-radius: 8px;
           border: 1px solid var(--border-color) ;
         }
         .dossier-s:focus {
           border-color: var(--primary);
           box-shadow: 0 0 6px var(--primary);
           transition: all 0.2s;
           outline: none;
        }
         body.dark-mode .dossier-s {
           background-color: black;
           color: #fff;
           border-color: #555;
         }
         .l-dossier-s {
            display: flex;
            margin-top: 10px;
            margin-left: 270px;
         }
         .parcourir-btn {
            margin-left: 270px;
            margin-top: 20px;
            background-color: #fff;
            color: var(--primary);
            border-radius: 8px;
            border: 1px solid var(--primary);
            padding: 4px 8px;
            cursor: pointer;
         }
         .parcourir-btn:hover {
          background-color: var(--secondary);
          color: #fff;
          transform: scale(1.05);
         }
         body.dark-mode .parcourir-btn {
          background-color: black;
          color: var(--primary);
          border: 1px solid var(--secondary);
         }
         .reset-global-btn {
          background-color: white;
          color: var(--primary);
          border: 2px solid var(--primary);
          cursor: pointer;
          transition: all 0.2s; 
          border-radius: 8px;
          padding: 6px 14px;
          margin-top: 20px;
          height: 35px;
          width: 50px;
          display: block;
          margin-left: 20px;
          margin-top: 10px;
          font-weight: bold;
         }
         body.dark-mode .reset-global-btn {
          background-color: black;
          color: var(--primary);
          border: 2px solid var(--secondary);
         }
         .reset-global-btn:hover {
          background-color: var(--secondary);
          color: #fff;
          transform: scale(1.05);
         }
         #message-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
         }
         #message-container:empty {
            display: none;
         }
         .message {
            position: fixed;
            top: 50%;
            left: 28%;
            transform: translateY(-50%, -50%);
            background: #fff;
            color: var(--text-dark);
            border-radius: 12px;
            padding: 16px 24px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            max-width: 80%;
            font-size: 1rem;
            z-index: 3000;
            animation: fadeInOut 3s ease forwards;
            text-align: center;
         }
         body.dark-mode #message-container .message {
            box-shadow: none;
         }
         .message.warning {
            border-color: var(--secondary);
            background-color: rgba(0, 195, 137, 0.1);
            color: var(--secondary);
         }
         .message.error {
            border-color: var(--accent);
            background-color:rgba(255, 107, 53, 0.1);
            color: var(--accent);
         }
         .message.info {
            border-color: var(--primary);
            background-color: rgba(0, 86, 210, 0.1);
            color: var(--primary);
         }
         .message.success {
            border: 1px solid var(--secondary);
            background-color: rgba(0,195,137,0.06);
            color: var(--secondary);
         }
         body.dark-mode .message {
           border-color: var(--secondary);
           background-color: #444;
           color: var(--dark-text);
         }
         body.dark-mode .message.warning {
            border-color: var(--secondary);
            background-color: rgba(0, 195, 137, 0.1);
            color: var(--secondary);
         }
         body.dark-mode .message.error {
            border-color: var(--accent);
            background-color:rgba(255, 107, 53, 0.1);
            color: var(--accent)
         }
         body.dark-mode .message.info {
            border-color: var(--primary);
            background-color: rgba(0, 86, 210, 0.1);
            color: var(--primary);
         }
         body.dark-mode .message.success {
            border: 1px solid var(--secondary);
            background-color: rgba(0,195,137,0.06);
            color: var(--secondary);
         }

</style>
</head>
<body> 
    
    <div id="loader" style="display:none;">Chargement...</div>

        <header>
        <h1>Freq-plan</h1>
        <nav>
            <a href="#Var">Variables</a>
            <a href="#Zones">Zones</a>
            <a href="#Freq">Fr√©quences</a>
            <a href="#BandeHP">Bandes HP</a>
            <a href="#BandeX">Bandes √† exclure</a>
            <a href="#Fichier">Fichier</a>
        </nav>
        <button id="version2" class="version-2">‚äû</button>
        <button id="themeToggle">üåô</button>
    </header>

    <div class="sections-wrapper">
    <section id="Var">

        <h2>Variables</h2>
        
    <div class="var-inner">

        <div class="variable-row">
        <label for="startFreq" class="label-bande">Bande :</label>
        <div class="bande-inputs">
            <div class="number-wrapper input-start-bande">
                 <input type="number" id="startFreq" class="input-bande" value="470" onfocus="if(this.value=='470') this.value='';" 
       onblur="if(this.value=='') this.value='470';" step="1">
            </div>
            <span class="unit-arrow">‚Üí</span>
             <div class="number-wrapper input-end-bande">
                 <input type="number" id="endFreq" class="input-bande" value="694" onfocus="if(this.value=='694') this.value='';" 
       onblur="if(this.value=='') this.value='694';" step="1">
            </div>
            <span class="unit-mhz">MHz</span>
        </div>
    </div>

        <div class="variable-row">
            <label for="pas" class="label-pas">Pas :</label>
            <div class="number-wrapper input-pas">
                <input type="number" id="pas" class="input-variable" value="25" onfocus="if(this.value=='25') this.value='';" 
       onblur="if(this.value=='') this.value='25';" step="1">
            </div>
            <span class="unit-khz">KHz</span>
        </div>

        <div class="variable-row">
            <label for="minLP" class="label-minLP">√âcart minimum LP :</label>
              <div class="number-wrapper input-minLP">
                <input type="number" id="minLP" class="input-variable" value="300" onfocus="if(this.value=='300') this.value='';" 
       onblur="if(this.value=='') this.value='300';" step="1">
            </div>
            <span class="unit-khz">KHz</span>
        </div>

        <div class="variable-row">
            <label for="minHP" class="label-minHP">√âcart minimum HP :</label>
            <div class="number-wrapper input-minHP">
                <input type="number" id="minHP" class="input-variable" value="400" onfocus="if(this.value=='400') this.value='';" 
       onblur="if(this.value=='') this.value='400';" step="1">
        </div>
        <span class="unit-khz">KHz</span>
        </div>

        <div class="variable-row">
            <label for="LpHpSpacing" class="label-LpHpSpacing">√âcart LP-HP :</label>
              <div class="number-wrapper input-LpHpSpacing">
               <input type="number" id="LpHpSpacing" class="input-variable" value="3" onfocus="if(this.value=='3') this.value='';" 
       onblur="if(this.value=='') this.value='3';" step="1">
            </div>
            <span class="unit-mhz">MHz</span>
        </div>

        <div class="variable-row">
            <label class="label-intermod">Intermodulation :</label>
            <div class="im-controls">
            <button type="button" class="im-btn" data-mode="ON">ON</button>
            <button type="button" class="im-btn" data-mode="AUTO">AUTO</button>
            <button type="button" class="im-btn" data-mode="MANUEL">MANUEL</button>
        </div>
    </div>

        <div class="variable-row" id="sensibiliteRow" style="display:none;">
            <label for="sensibilite" class="label-sensibilite">Sensibilit√© :</label>
             <div class="number-wrapper input-sensibilite">
              <input type="number" id="sensibilite" class="input-variable" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';" step="1">
            </div>
            <span class="unit-khz">KHz</span>
        </div>
    </div>

    <div class="variable-row">
        <button id="resetVariableBtn" class="reset-variable-btn">‚ü≥</button>
    </div>

    </section>

    <section id="Zones">
    <h2>Zones</h2>
    <div class="zone-container">

        <div class="zone-row">
            <label>LP :</label>
            <div class="number-wrapper">
                 <input type="number" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';" class="lp-input" step="1">
            </div>

            <label>HP :</label>
            <div class="number-wrapper">
                <input type="number" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';" class="hp-input" step="1">
            </div>
        </div>

        <div class="zone-list">
            <div class="zone-item" data-zone-id="1">
                <div class="zone-main">
                    <input type="text" value="Zone 1" onfocus="if(this.value=='Zone 1') this.value='';" 
       onblur="if(this.value=='') this.value='Zone 1';" class="zone-name">

                    <div class="number-wrapper">
                        <input type="number" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';" class="zone-value" step="1">
                    </div>
                    
                    <button class="remove-zone-btn">-</button>
                </div>
            </div>
        </div>
        <div class="zone-controls">
        <button class="add-zone-btn">+</button>
        <button class="reset-zone-btn">‚ü≥</button>
        </div>
      
        <div class="alternance-container" style="display:none;">
    <label>Alternance :</label>
    <div class="number-wrapper">
        <input type="number" id="alternanceGlobal" value="2" onfocus="if(this.value=='2') this.value='';" 
       onblur="if(this.value=='') this.value='2';" step="1">
    </div>
    <span>MHz</span>
</div>

    </div>
</section>

    <section id="Freq">
        <h2>Fr√©quences</h2>
        <div id="freqContainer">
            <div class="freq-row">
                <label>Freq :</label>
                <div class="number-wrapper">
                    <input type="number" class="freq-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';" step="1">
                </div>

                <select class="pwr-select">
                    <option value="LP">LP</option>
                    <option value="HP">HP</option>
                </select>
                <select class="zone-select">
                    <option value="common">Common Zone</option>
                </select>

                <button class="remove-freq-btn">-</button>
            </div>
        </div>
        <div class="freq-controls">
            <button id="addFreqBtn" class="add-zone-btn">+</button>
            <button class="reset-freq-btn">‚ü≥</button>
        </div>
    </section>

    <section id="BandeHP">
        <h2>Bandes HP</h2>
        <div id="bandeHPContainer">
            <div class="bande-row">
                <div class="number-wrapper">
                    <input type="number" class="bande-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';">
                </div>
                <span>‚Üí</span>
                <div class="number-wrapper">
                    <input type="number" class="bande-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';">
                </div>
                <span>MHZ</span>
                <button class="remove-bande-btn">-</button>
            </div>
        </div>
        <div class="bande-controls">
            <button id="addBandeHPBtn">+</button>
            <button id="resetBandeHPBtn">‚ü≥</button>
        </div>
    </section>

    <section id="BandeX">
        <h2>Bandes √† exclure</h2>
         <div id="bandeXContainer">
            <div class="bande-row">
                <div class="number-wrapper">
                    <input type="number" class="bande-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';">
                </div>
                <span>‚Üí</span>
                <div class="number-wrapper">
                    <input type="number" class="bande-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';">
                </div>
                <span>MHZ</span>
                <button class="remove-bande-btn">-</button>
            </div>
        </div>
        <div class="bande-controls">
            <button id="addBandeXBtn">+</button>
            <button id="resetBandeXBtn">‚ü≥</button>
        </div>
    </section>

    <section id="Fichier">
        <h2>Fichier</h2>
        <label for="name-f" class="l-name-f">Nom du Fichier : </label>
        <input class="name-f">
        <label for="dossier-s" class="l-dossier-s">Dossier de sortie : </label>
        <input class="dossier-s">
        <button id="parcourirBtn" class="parcourir-btn">Parcourir</button>
        <button id="runCalcBtn">G√©n√©rer</button>
        <button id="resetAllBtn" class="reset-global-btn">‚ü≥</button>
    </section>

    </div>

    <button id="scrollTopBtn">‚Üë</button>

    <div id="message-container"></div>

  <script>

const scrollTopBtn = document.getElementById("scrollTopBtn");
const toggleBtn = document.getElementById("themeToggle");
const body = document.body;
const header = document.querySelector("header");
const navLinks = document.querySelectorAll("header nav a");
const sections = document.querySelectorAll("section");

let isClickScrolling = false;

navLinks.forEach(link => {
    link.addEventListener("click", e => {
        e.preventDefault();
        const targetId = link.getAttribute("href").substring(1);
        const targetSection = document.getElementById(targetId);

        navLinks.forEach(l => l.classList.remove("active"));
        link.classList.add("active");

        isClickScrolling = true;

        window.scrollTo({
            top: targetSection.offsetTop - header.offsetHeight,
            behavior: 'smooth'
        });

        setTimeout(() => { isClickScrolling = false; }, 600);
    });
});

window.addEventListener("scroll", () => {
    if (isClickScrolling) return;

    let current = sections[0].id;
    sections.forEach(section => {
        if (window.scrollY >= section.offsetTop - header.offsetHeight - 2) {
            current = section.id;
        }
    });

    if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 2) {
        current = sections[sections.length - 1].id;
    }

    navLinks.forEach(link => {
        link.classList.remove("active");
        if (link.getAttribute("href") === "#" + current) link.classList.add("active");
    });

    scrollTopBtn.style.display = window.scrollY > 200 ? "block" : "none";
});

scrollTopBtn.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });

if (localStorage.getItem("theme") === "dark") {
    body.classList.add("dark-mode");
    header.classList.add("dark-mode");
    navLinks.forEach(link => link.classList.add("dark-mode"));
    toggleBtn.textContent = "‚òÄÔ∏è";
}

toggleBtn.addEventListener("click", () => {
    body.classList.toggle("dark-mode");
    header.classList.toggle("dark-mode");
    navLinks.forEach(link => link.classList.toggle("dark-mode"));
    if (body.classList.contains("dark-mode")) {
        toggleBtn.textContent = "‚òÄÔ∏è";
        localStorage.setItem("theme", "dark");
    } else {
        toggleBtn.textContent = "üåô";
        localStorage.setItem("theme", "light");
    }
});

function showLoader() { document.getElementById("loader").style.display = "flex"; }
function hideLoader() { document.getElementById("loader").style.display = "none"; }

async function runPythonCalculation() {
    try {
        showLoader();
        const response = await fetch("/run-calculation");
        const data = await response.json();
        console.log("R√©sultat :", data);
    } catch (error) {
        console.error("Erreur pendant le calcul :", error);
    } finally {
        hideLoader();
    }
}
document.getElementById("runCalcBtn").addEventListener("click", runPythonCalculation);

const imButtons = document.querySelectorAll(".im-btn");
const sensibiliteRow = document.getElementById("sensibiliteRow");

imButtons.forEach(btn => {
    btn.addEventListener("click", () => {
        imButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        if (btn.dataset.mode === "MANUEL") {
            sensibiliteRow.style.display = "flex"; 
        } else {
            sensibiliteRow.style.display = "none";  
            document.getElementById("sensibilite").value = '';
        }
    });
});


document.querySelectorAll(
    '.number-wrapper:not(#bandeHPContainer .number-wrapper):not(#bandeXContainer .number-wrapper)'
);

const addZoneBtn = document.querySelector('.add-zone-btn');
const zoneList = document.querySelector('.zone-list');
let zoneCount = 0;
const zoneContainer = document.querySelector('.zone-container');

const resetZoneBtn = document.querySelector('.reset-zone-btn');

resetZoneBtn.addEventListener('click', () => {
    zoneList.querySelectorAll('.zone-item').forEach((zone, index) => {
        if (index === 0) {
            zone.style.display = 'none';
            zone.querySelector('.zone-name').value = 'Zone 1';
            zone.querySelector('.zone-value').value = 0;
        } else {
            zone.remove();
        }
    });

    document.querySelectorAll('.lp-input, .hp-input').forEach(input => input.value = 0);

    const alternanceContainer = document.querySelector('.alternance-container');
    alternanceContainer.style.display = 'none';
    alternanceContainer.querySelector('input').value = 2;

    zoneCount = 0;
    updateZoneOptions();
});

const firstZone = zoneList.querySelector('.zone-item');
if(firstZone) firstZone.style.display = 'none';

addZoneBtn.addEventListener('click', () => {
    if (zoneCount === 0 && firstZone) {
        firstZone.style.display = 'flex';
        const alternanceContainer = document.querySelector('.alternance-container');
        alternanceContainer.style.display = 'flex';
        alternanceContainer.parentNode.insertBefore(alternanceContainer, zoneContainer.querySelector('.zone-controls'));
        zoneCount = 1;
        updateZoneOptions();

        const firstRemoveBtn = firstZone.querySelector('.remove-zone-btn');
        if(firstRemoveBtn) {
            firstRemoveBtn.onclick = () => {
                firstZone.style.display = 'none';
                firstZone.querySelector('.zone-name').value = 'Zone 1';
                firstZone.querySelector('.zone-value').value = 0;
                zoneCount = 0;

                alternanceContainer.style.display = 'none';
                alternanceContainer.querySelector('input').value = 2;
                updateZoneOptions();
            };
        }
        return;
    }

    zoneCount++;
    const zoneItem = document.createElement('div');
    zoneItem.classList.add('zone-item');
    zoneItem.dataset.zoneId = zoneCount;

    zoneItem.innerHTML = `
        <div class="zone-main">
            <input type="text" value="Zone ${zoneCount}" onfocus="if(this.value=='Zone ${zoneCount}') this.value='';" 
       onblur="if(this.value=='') this.value='Zone ${zoneCount}';" class="zone-name">
            <div class="number-wrapper">
                <input type="number" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';" class="zone-value" step="1">
            </div>
            <button class="remove-zone-btn">-</button>
        </div>
    `;

    zoneList.appendChild(zoneItem);
    zoneItem.querySelectorAll('.number-wrapper');

    const removeBtn = zoneItem.querySelector('.remove-zone-btn');
    removeBtn.addEventListener('click', () => {
        zoneItem.remove();
        updateZoneOptions();
        zoneCount--;
        if(zoneCount === 0 && firstZone) {
            firstZone.style.display = 'none';
            document.querySelector('.alternance-container').style.display = 'none';
        }
    });

    document.querySelector('.alternance-container').style.display = 'flex';
    updateZoneOptions();
});

const freqContainer = document.getElementById('freqContainer');
const addFreqBtn = document.getElementById("addFreqBtn");
const resetFreqBtn = document.querySelector('.reset-freq-btn');

function updateZoneOptions() {
    const zoneNames = Array.from(document.querySelectorAll('.zone-list .zone-item'))
        .filter(zone => zone.style.display !== 'none')
        .map(zone => zone.querySelector('.zone-name').value)
        .filter(name => name.trim() !== '');

    freqContainer.querySelectorAll('.zone-select').forEach(select => {
        const currentValue = select.value;
        select.innerHTML = '<option value="common">Common Zone</option>';
        zoneNames.forEach(name => {
            const opt = document.createElement('option');
            opt.value = name;
            opt.textContent = name;
            select.appendChild(opt);
        });
        select.value = zoneNames.includes(currentValue) ? currentValue : 'common';
    });
}

function createFreqRow(freqValue = '', isFirst = false) {
    const row = document.createElement('div');
    row.classList.add('freq-row');
    row.innerHTML = `
        <label>Freq :</label>
        <div class="number-wrapper">
            <input type="number" class="freq-input" value="${freqValue || 0}"onfocus="if(this.value=='${freqValue || 0}') this.value='';" 
       onblur="if(this.value=='') this.value='${freqValue || 0}';">
        </div>
        <select class="pwr-select">
            <option value="LP">LP</option>
            <option value="HP">HP</option>
        </select>
        <select class="zone-select">
            <option value="common">Common Zone</option>
        </select>
        <button class="remove-freq-btn">-</button>
    `;

    freqContainer.appendChild(row);

    const input = row.querySelector('.freq-input');
    const upBtn = row.querySelector('.up');
    const downBtn = row.querySelector('.down');
    const removeBtn = row.querySelector('.remove-freq-btn');

    if (isFirst) removeBtn.style.display = 'none';
    else removeBtn.addEventListener('click', () => { row.remove(); });

    input.addEventListener('input', () => {
        const lastRow = freqContainer.querySelector('.freq-row:last-child input');
        if (lastRow === input && input.value !== '' && !input.dataset.added) {
            input.dataset.added = 'true';
            createFreqRow('', false);
        }
    });

    updateZoneOptions();
}

freqContainer.innerHTML = '';
createFreqRow('', true);

addFreqBtn.addEventListener("click", () => createFreqRow('', false));
resetFreqBtn.addEventListener('click', () => {
    freqContainer.querySelectorAll('.freq-row').forEach(row => row.remove());
    createFreqRow('', true);
});

const bandeHPContainer = document.getElementById('bandeHPContainer');
const addBandeHPBtn = document.getElementById('addBandeHPBtn');
const resetBandeHPBtn = document.getElementById('resetBandeHPBtn');

document.querySelectorAll('#bandeHPContainer .bande-row').forEach((row, index) => {
    row.querySelectorAll('.number-wrapper');
    const removeBtn = row.querySelector('.remove-bande-btn');
    if(index === 0 && removeBtn) removeBtn.style.display = 'none';
});

function createBandeRow() {
    const row = document.createElement('div');
    row.classList.add('bande-row');
    row.innerHTML = `
        <div class="number-wrapper">
            <input type="number" class="bande-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';">
        </div>
        <span>‚Üí</span>
        <div class="number-wrapper">
            <input type="number" class="bande-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';">
        </div>
        <span>MHz</span>
        <button class="remove-bande-btn">-</button>
    `;
    bandeHPContainer.appendChild(row);
    row.querySelectorAll('.number-wrapper');
    const removeBtn = row.querySelector('.remove-bande-btn');
    removeBtn.addEventListener('click', () => row.remove());
}

addBandeHPBtn.addEventListener('click', createBandeRow);

resetBandeHPBtn.addEventListener('click', () => {
    const bandeRows = bandeHPContainer.querySelectorAll('.bande-row');
    bandeRows.forEach((row, index) => {
        if (index !== 0) row.remove();
    });
    const firstInputs = bandeHPContainer.querySelectorAll('.bande-row:first-child .bande-input');
    firstInputs.forEach(input => input.value = 0);
    const firstRow = bandeHPContainer.querySelector('.bande-row:first-child');
    if (firstRow) firstRow.querySelector('.remove-bande-btn').style.display = 'none';
});

const bandeXContainer = document.getElementById('bandeXContainer');
const addBandeXBtn = document.getElementById('addBandeXBtn');
const resetBandeXBtn = document.getElementById('resetBandeXBtn');

document.querySelectorAll('#bandeXContainer .bande-row').forEach((row, index) => {
    row.querySelectorAll('.number-wrapper');
    const removeBtn = row.querySelector('.remove-bande-btn');
    if(index === 0 && removeBtn) removeBtn.style.display = 'none';
});

function createBandeXRow() {
    const row = document.createElement('div');
    row.classList.add('bande-row');
    row.innerHTML = `
        <div class="number-wrapper">
            <input type="number" class="bande-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';">
        </div>
        <span>‚Üí</span>
        <div class="number-wrapper">
            <input type="number" class="bande-input" value="0" onfocus="if(this.value=='0') this.value='';" 
       onblur="if(this.value=='') this.value='0';">
        </div>
        <span>MHz</span>
        <button class="remove-bande-btn">-</button>
    `;
    bandeXContainer.appendChild(row);
    row.querySelectorAll('.number-wrapper');
    const removeBtn = row.querySelector('.remove-bande-btn');
    removeBtn.addEventListener('click', () => row.remove());
}

addBandeXBtn.addEventListener('click', createBandeXRow);

resetBandeXBtn.addEventListener('click', () => {
    const bandeRows = bandeXContainer.querySelectorAll('.bande-row');
    bandeRows.forEach((row, index) => {
        if (index !== 0) row.remove();
    });
    const firstInputs = bandeXContainer.querySelectorAll('.bande-row:first-child .bande-input');
    firstInputs.forEach(input => input.value = 0);
    const firstRow = bandeXContainer.querySelector('.bande-row:first-child');
    if (firstRow) firstRow.querySelector('.remove-bande-btn').style.display = 'none';
});

const resetVariableBtn = document.getElementById('resetVariableBtn');
resetVariableBtn.addEventListener('click', () => {
    const defaultValues = {
        startFreq: 470,
        endFreq: 694,
        pas: 25,
        minLP: 300,
        minHP: 400,
        LpHpSpacing: 3,
        sensibilite: 0
    };
    Object.keys(defaultValues).forEach(id => {
        const input = document.getElementById(id);
        if (input) input.value = defaultValues[id];
    });
    document.querySelectorAll('.im-btn').forEach(btn => btn.classList.remove('active'));
    document.getElementById('sensibiliteRow');
    sensibiliteRow.style.display = 'none';
    document.getElementById('sensibilite').value = '';
})

document.getElementById('resetAllBtn').addEventListener('click', () => {
    const scrollPos = window.scrollY;
    document.getElementById('startFreq').value = 470;
    document.getElementById('endFreq').value = 694;
    document.getElementById('pas').value = 25;
    document.getElementById('minLP').value = 300;
    document.getElementById('minHP').value = 400;
    document.getElementById('LpHpSpacing').value = 3;
    document.querySelectorAll('.im-btn').forEach(btn => btn.classList.remove('active'));
    document.getElementById('sensibiliteRow').style.display = 'none';
    document.getElementById('sensibilite').value = '';
    document.querySelector('.reset-zone-btn').click();
    document.querySelector('.reset-freq-btn').click();
    document.getElementById('resetBandeHPBtn').click();
    document.getElementById('resetBandeXBtn').click();
    window.scrollTo({ top: 0, behavior: 'smooth' });
    window.scrollTo(0, scrollPos);
})


function showMessage(type, text, duration = 5000) {
  const container = document.getElementById("message-container");
  container.innerHTML = "";
  const msg = document.createElement("div");
  msg.className = "message " + type; 
  msg.innerText = text;
  container.appendChild(msg);

  setTimeout(() => {
    if (msg.parentElement) msg.remove();
  }, duration);
}

async function runPythonCalculation() {
  try {
    showLoader();
    const response = await fetch("/run-calculation");
    if (!response.ok) {
      console.error("HTTP error", response.status);
      return null;
    }
    const data = await response.json();
    console.log("R√©sultat serveur :", data);
    return data;
  } catch (error) {
    console.error("Erreur pendant le calcul :", error);
    return null;
  } finally {
    hideLoader();
  }
}

async function validateAndGenerate(e) {
  e && e.preventDefault && e.preventDefault();

  const params = (document.getElementById("params") || {value:''}).value.trim();
  const outputPath = (document.getElementById("output-path") || {value:''}).value.trim();
  const freqCountRaw = (document.getElementById("freq-count") || {value:''}).value;
  const freqCount = parseInt(freqCountRaw === '' ? NaN : freqCountRaw, 10);
  const manualLine = (document.getElementById("manual-line") || {value:''}).value.trim();
  const spectrum = (() => {
     const v = (document.getElementById("spectrum")||{value:''}).value;
     const n=parseFloat(v); return isNaN(n)?null:n; 
    })
 ();
  const band = (() => {
     const v = (document.getElementById("band")||{value:''}).value;
     const n=parseFloat(v); return isNaN(n)?null:n;
     })
  ();

  const sensibiliteEl = document.getElementById("sensibilite");
  const sensitivityEl  = document.getElementById("sensitivity");
  const sensibiliteVal = (sensibiliteEl && sensibiliteEl.value !== undefined) ? sensibiliteEl.value.trim() : "";
  const sensitivityVal  = (sensitivityEl && sensitivityEl.value !== undefined) ? sensitivityEl.value.trim() : "";

  const isManualModeBtn = document.querySelector('.im-btn.active') && document.querySelector('.im-btn.active').dataset.mode === 'MANUEL';
  const sensRow = document.getElementById('sensibiliteRow');
  const sensRowVisible = sensRow && window.getComputedStyle(sensRow).display !== 'none';
  const sensibiliteRequired = isManualModeBtn || sensRowVisible;

  const errors = [];
  const warnings = [];

  if (!params) {
    errors.push("LP = 0; HP = 0 Remplis au moins un champs, je vais pas tout faire");
  }

  if (sensibiliteRequired) {
    const anySensProvided = (sensibiliteEl && sensibiliteVal !== "") || (sensitivityEl && sensitivityVal !== "");
    if (!anySensProvided) {
      errors.push("D√©finir sensibilit√© ou prendre un caf√©");
    }
  }

  if (!outputPath) {
    errors.push("Et je mets √ßa o√π, moi ?");
  }

  if (isNaN(freqCount) || freqCount <= 0) {
    errors.push("Veuillez pr√©ciser le nombre de fr√©quences √† g√©n√©rer.");
  }

  if (spectrum !== null && band !== null) {
    if (spectrum >= band) {
      errors.push("Le spectre demand√© est √©gal ou sup√©rieur √† la bande disponible.");
    }
  }

  if (manualLine !== "") {
    if (manualLine.includes(',')) {
      const parts = manualLine.split(',').map(p => p.trim());
      if (parts.some(p => p === "")) {
        errors.push("La ligne manuelle est incompl√®te. Compl√®te tous les champs s√©par√©s par des virgules.");
      }
    }
  }

  if (!isNaN(freqCount) && freqCount < 3) {
    warnings.push("Attention : moins de trois fr√©quences demand√©es.");
  }

  if (errors.length > 0) {
    showMessage("error", errors[0]);
    return;
  }

  if (warnings.length > 0) {
    showMessage("warning", warnings.join(" "));
    await new Promise(res => setTimeout(res, 600));
  }

  const serverData = await runPythonCalculation();

  if (serverData === null) {
    showMessage("error", "Erreur lors de la g√©n√©ration (probl√®me serveur ou r√©seau).");
    return;
  }

  let foundResults = true;
  if (Array.isArray(serverData) && serverData.length === 0) foundResults = false;
  else if (serverData && Array.isArray(serverData.results) && serverData.results.length === 0) foundResults = false;
  else if (serverData && serverData.success === false && (serverData.results === undefined || (Array.isArray(serverData.results) && serverData.results.length === 0))) {
    foundResults = false;
  }

  if (!foundResults) {
    showMessage("info", "Aucun r√©sultat trouv√©.");
    return;
  }

  showMessage("success", "x fr√©quences g√©n√©r√©es et enregistr√©es !");
}

   (function replaceRunButtonListener() {
  const runBtn = document.getElementById("runCalcBtn");
  if (!runBtn) return;
  const clone = runBtn.cloneNode(true);
  runBtn.parentNode.replaceChild(clone, runBtn);
  const freshRunBtn = document.getElementById("runCalcBtn");
  freshRunBtn.addEventListener("click", validateAndGenerate);
})();
const version2Btn = document.getElementById("version2");
let isFullScreen = false;

version2Btn.addEventListener("click", () => {
    isFullScreen = !isFullScreen;

    if (isFullScreen) {
        const screenWidth = window.screen.availWidth;
        const screenHeight = window.screen.availHeight;

        window.moveTo(0, 0);

        window.resizeTo(screenWidth, screenHeight);

        version2Btn.textContent = "üóó"; 
    } else {
        const screenWidth = window.screen.availWidth;
        const screenHeight = window.screen.availHeight;

        window.moveTo(screenWidth / 2, 0); 
        window.resizeTo(screenWidth / 2, screenHeight); 

        version2Btn.textContent = "‚äû";
    }
});


</script>
</body>
</html>